library(tidyverse)
library(magrittr)
library(enrichR)

genes <- c("lep",
           "fabp4",
           "il1rn",
           "igsf9",
           "ldlr",
           "afm",
           "inhbc",
           "plat",
           "hgf",
           "furin",
           "agrn",
           "igfbp2",
           "ckb",
           "prap1",
           "apcs",
           "f7",
           "prss8",
           "nppc",
           "acp5",
           "sez6l",
           "lcat",
           "cpm",
           "cdcp1",
           "heg1",
           "rtn4r",
           "cfp",
           "cfi",
           "sfrp1",
           "ces1",
           "rarres2",
           "igfbp1",
           "cd4",
           "prcp",
           "trem2",
           "f9",
           "erbb2",
           "c1r",
           "celsr2",
           "rtbdn",
           "oxt",
           "bpifb2",
           "ctsd",
           "ghr",
           "pon3",
           "sost",
           "npy",
           "lgals1",
           "pts",
           "fn1",
           "cst3",
           "gusb",
           "ccl7",
           "vnn1",
           "nomo1",
           "il18r1",
           "nrcam",
           "c1rl",
           "lpl",
           "cxcl17",
           "ssc4d",
           "gpd1",
           "bche",
           "adgrg1",
           "gsta1",
           "cytl1",
           "ccl22",
           "nt5c1a",
           "ccl27",
           "krt18",
           "gla",
           "atrn",
           "ca14",
           "acy1",
           "ang",
           "lgals3bp",
           "icam1",
           "dcxr",
           "igfbp6",
           "ccl20",
           "rida",
           "smndc1",
           "mep1a",
           "serpinf1",
           "aldh1a1",
           "ptprn2",
           "ism1",
           "mxra8",
           "pcbd1",
           "ssc5d",
           "ifi30",
           "hip1r",
           "fgfr2",
           "vgf",
           "sord",
           "adh4",
           "tafa5",
           "gsta3",
           "ptprm",
           "cfb",
           "palm",
           "cd38",
           "sorcs2",
           "plin1",
           "cdhr2",
           "ccl18",
           "ddt",
           "colec12",
           "susd4",
           "adipoq",
           "pltp",
           "rbp5",
           "serpind1",
           "tnfrsf11a",
           "gchfr",
           "vegfb",
           "hs6st2",
           "osm",
           "cd83",
           "stc1",
           "fgf21",
           "serpinf2",
           "nos3",
           "rnase4",
           "igsf3",
           "c1s",
           "snca",
           "asgr1",
           "calb2",
           "itga5",
           "ak1",
           "smoc1",
           "cxcl10",
           "scarb2",
           "scg2",
           "calb1",
           "cdhr5",
           "proc",
           "pth",
           "ccl16",
           "penk",
           "fam20a",
           "a1bg",
           "egln1",
           "mad1l1",
           "lrpap1",
           "cd302",
           "idua",
           "btd",
           "parp1",
           "ptprb",
           "ntprobnp",
           "creg1",
           "clec4a",
           "kynu",
           "c3",
           "cfc1",
           "cbln4",
           "fuom",
           "npdc1",
           "sod1",
           "ncan",
           "fabp5",
           "igsf8",
           "dtymk",
           "pgf",
           "thop1",
           "fga",
           "npc2",
           "lamp2",
           "agr3",
           "clmp",
           "prnd",
           "ahsp",
           "hnmt",
           "ptgds",
           "ssna1",
           "c19orf12",
           "baiap2",
           "ggh",
           "tnfrsf10b",
           "efcab14",
           "ltbp3",
           "cntn3",
           "cstb",
           "tgfa",
           "serpina4",
           "npl",
           "fetub",
           "adm",
           "ptprr",
           "eloa",
           "clu",
           "khk",
           "tfpi",
           "cxcl13",
           "ccn1",
           "wfdc2",
           "sele",
           "tctn3",
           "apof",
           "nell2",
           "rbks",
           "palm2",
           "cpxm2",
           "ggt1",
           "snx15",
           "mrc1",
           "dnajb1",
           "gcg",
           "smad5",
           "olr1",
           "scly",
           "cd209",
           "capg",
           "nectin4",
           "ftcd",
           "shisa5",
           "ccl11",
           "psap",
           "dpt",
           "bap18",
           "ces2",
           "cdh15",
           "fcamr",
           "gpr37",
           "sdc1",
           "gpkow",
           "mmp7",
           "anxa2",
           "gast",
           "notch3",
           "yod1",
           "ctsz",
           "heph",
           "slitrk1",
           "ocln",
           "angptl7",
           "clec4m",
           "dsg2",
           "ctbs",
           "sncg",
           "vsnl1",
           "s100a13",
           "mog",
           "cdh2",
           "mfge8",
           "srp14",
           "cfd",
           "ncam1",
           "ahnak",
           "hhex",
           "epha1",
           "mmp9",
           "qdpr",
           "sh3glb2",
           "ifngr2",
           "tnfrsf1a",
           "rpl14",
           "nhlrc3",
           "crip2",
           "pros1",
           "s100a11",
           "kdr",
           "muc13",
           "adamts15",
           "gdf15",
           "pigr",
           "ptp4a3",
           "hnrnpul1",
           "hrc",
           "tnfsf14",
           "apex1",
           "iglc2",
           "cd300lg",
           "polr2f",
           "ptgr1",
           "il1rap",
           "havcr1",
           "syt1",
           "cd99l2",
           "fgr",
           "slc39a5",
           "il10rb",
           "serpina7",
           "pxn",
           "ccn4",
           "vsig2",
           "optc",
           "hao1",
           "kiaa0319",
           "tgfbr2",
           "crhbp",
           "mnda",
           "dynlt1",
           "ctsb",
           "c2",
           "snrpb2",
           "ccer2",
           "acaa1",
           "bid",
           "taldo1",
           "zhx2",
           "dpy30",
           "thy1",
           "apbb1ip",
           "ddah1",
           "nit2",
           "ptprz1",
           "agrp",
           "ccl19",
           "cpb2",
           "septin8",
           "lsp1",
           "il17rb",
           "ncf2",
           "cemip2",
           "fstl3",
           "plaur",
           "crtac1",
           "mzb1",
           "itgav",
           "st3gal1",
           "upb1",
           "myom3",
           "megf10",
           "adh1b",
           "tnfrsf4",
           "esm1",
           "ca5a",
           "yap1",
           "sftpd",
           "hsd11b1",
           "crybb2",
           "rnase6",
           "pamr1",
           "cep290",
           "itga11",
           "itgam",
           "susd5",
           "nadk",
           "sema3f",
           "ager",
           "ccl23",
           "rbp7",
           "mtus1",
           "il16",
           "treh",
           "bmper",
           "robo2",
           "ren",
           "lgals4",
           "mvk",
           "efna4",
           "c5",
           "ca6",
           "rnase1",
           "nbn",
           "prrt3",
           "cd59",
           "skap1",
           "plg",
           "col4a1",
           "pbld",
           "ctso",
           "tpr",
           "hjv",
           "adamtsl2",
           "nppb",
           "vwa1",
           "f10",
           "inhbb",
           "stab2",
           "fabp3",
           "glb1",
           "asah2",
           "shbg",
           "ttr",
           "cda",
           "nfasc",
           "lamb1",
           "itih3",
           "ace2",
           "nagpa",
           "golm2",
           "tnfrsf12a",
           "lilra5",
           "serpina5",
           "fmnl1",
           "igf2r",
           "ncs1",
           "tgfb1",
           "ezr",
           "tff2",
           "b3gnt7",
           "adgrd1",
           "ampd3",
           "sort1",
           "ass1",
           "cd63",
           "gfral",
           "wars",
           "pagr1",
           "efemp1",
           "tfrc",
           "igfbp3",
           "pcsk9",
           "il1r2",
           "col1a1",
           "chgb",
           "vwc2l",
           "podxl2",
           "col5a1",
           "susd2",
           "myl3",
           "tnfrsf8",
           "gsr",
           "acan",
           "nptx1")
genes <- toupper(genes)



dbs <- c("GO_Biological_Process_2018", "GO_Cellular_Component_2018", 
         "GO_Molecular_Function_2018", "Reactome_2016", "Panther_2016", 
         "Human_Phenotype_Ontology",
         "MGI_Mammalian_Phenotype_2017", 
         "Jensen_TISSUES", "Jensen_DISEASES", "OMIM_Disease",
         "dbGaP", "DSigDB", "Human_Gene_Atlas", "Mouse_Gene_Atlas")

res <- map(genes, function(x) enrichr(x, dbs)) %>% set_names(genes)

res_bind <- parallel::mclapply(res, function(x) map(1:length(x), function(i) {
  # if (nrow(res[[i]])!=0){
  data_frame(paste0(x[[i]]$Term, collapse=', ')) %>% set_names(names(x[i]))
  # }
}) %>% bind_cols(), mc.cores=10) %>% bind_rows(.id='Gene')

write.csv(res_bind, 'enrich.idp.Jensen_TISSUES.csv')
